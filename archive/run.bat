@echo off
chcp 65001 > nul
REM ====================================================================
REM Скрипт быстрого запуска конвертера Docling
REM ====================================================================

echo.
echo ╔════════════════════════════════════════╗
echo ║   Запуск конвертера Docling            ║
echo ╚════════════════════════════════════════╝
echo.

REM Переходим в папку проекта (там где лежит .bat файл)
cd /d "%~dp0"

REM Активируем виртуальное окружение из родительской папки
echo [1/2] Активация виртуального окружения...
call ..\venv\Scripts\activate.bat

REM Проверяем активацию
if errorlevel 1 (
    echo.
    echo ❌ ОШИБКА: Не удалось активировать venv
    echo    Проверьте, что папка C:\VScode\venv существует
    echo.
    pause
    exit /b 1
)

echo      ✅ Окружение активировано
echo.

REM Запускаем конвертер
echo [2/2] Запуск конвертера...
python converter.py

REM Сохраняем код возврата
set exitcode=%errorlevel%

echo.
if %exitcode%==0 (
    echo ╔════════════════════════════════════════╗
    echo ║   ✅ Конвертер завершил работу         ║
    echo ╚════════════════════════════════════════╝
) else (
    echo ╔════════════════════════════════════════╗
    echo ║   ❌ Конвертер завершился с ошибкой    ║
    echo ╚════════════════════════════════════════╝
)

echo.
echo Нажмите любую клавишу для выхода...
pause > nul

exit /b %exitcode%
